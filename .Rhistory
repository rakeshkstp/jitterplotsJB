scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
ylbl <- expression(paste(italic("C"),{}[SPM]," [g",m^{-3},"]"))
ymax <- max(pdata$spmr,na.rm=TRUE)
ylim <- c(0,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(ylim[2]-ylim[1])
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ylim <- c(0.01,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(ylim[2]-ylim[1])
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ratio.values <- log10(xlim[2]-xlim[1])/(ylim[2]-ylim[1])
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ylbl <- expression(paste(italic("C"),{}[SPM]," [g",m^{-3},"]"))
ymax <- max(pdata$spmr,na.rm=TRUE)
ylim <- c(0.01,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ylim <- c(1,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ylim <- c(1,100)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ylbl <- expression(paste(italic("C"),{}[Chl-a]," [mg ",m^{-3},"]"))
ymax <- max(pdata$chl,na.rm=TRUE)
ylim <- c(0.01,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g3 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = chl, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = chl),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme
g3
ylim <- c(0.1,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g3 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = chl, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = chl),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme
g3
ylim <- c(0.1,100)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g3 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = chl, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = chl),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme
g3
ratio.display=4.5
xlim <- c(1,length(station))
ylbl <- expression(paste(italic("a"),{}[g],"(440 nm) [",m^{-1},"]"))
ymax <- max(pdata$ag440,na.rm=TRUE)
ylim <- c(0,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(ylim[2]-ylim[1])
asp_rat <- ratio.values/ratio.display
g1 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks),y = ag440, fill=Month),
shape=21,show.legend = TRUE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = ag440),trim=FALSE,show.legend = FALSE,alpha =0,size=1,color="black") +
#guides(fill= guide_colorbar(barwidth = 40, barheight = 0.5)) +
# annotate("text", x = c(1:9), y=75, label = paste0("N = ",cPp$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +  #seq(ymin, ymax, ystp)
scale_y_continuous(name = ylbl, limits = ylim,
breaks = pretty_breaks())  +  #seq(ymin, ymax, ystp)
mytheme  + theme(legend.position = c(0,1.25),plot.margin = unit(c(0.5,0,-0.5,0), "cm"),
axis.text.x = element_blank())
g1
ylbl <- expression(paste(italic("C"),{}[SPM]," [g",m^{-3},"]"))
ymax <- max(pdata$spmr,na.rm=TRUE)
ylim <- c(1,100)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ylbl <- expression(paste(italic("C"),{}[Chl-a]," [mg ",m^{-3},"]"))
ymax <- max(pdata$chl,na.rm=TRUE)
ylim <- c(0.1,100)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g3 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = chl, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = chl),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
#annotate("text", x = c(1:9), y=62, label = paste0("N = ",cPm$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme
g3
#   scale_colour_manual(values = gvals, breaks = gbreaks, labels = glabels) +
#   scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
#                        limits=c(1,12), labels=mlabels) +
#   scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
#   scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
#                      breaks = trans_breaks("log10", function(x) 10^round(x)),
#                      labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
#   mytheme
# g3
#
wdt <- 30
ht <- 22
if (save_figure)
{  if (!(grepl(".png", filename, fixed = TRUE)))
filename <- paste0(filename,".png")
png(filename, width = wdt, height = ht, units = "cm", res = 300, bg = "white")
}
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.95, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
#   scale_colour_manual(values = gvals, breaks = gbreaks, labels = glabels) +
#   scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
#                        limits=c(1,12), labels=mlabels) +
#   scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
#   scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
#                      breaks = trans_breaks("log10", function(x) 10^round(x)),
#                      labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
#   mytheme
# g3
#
wdt <- 32
ht <- 30
if (save_figure)
{  if (!(grepl(".png", filename, fixed = TRUE)))
filename <- paste0(filename,".png")
png(filename, width = wdt, height = ht, units = "cm", res = 300, bg = "white")
}
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.95, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.8, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
#   scale_colour_manual(values = gvals, breaks = gbreaks, labels = glabels) +
#   scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
#                        limits=c(1,12), labels=mlabels) +
#   scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
#   scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
#                      breaks = trans_breaks("log10", function(x) 10^round(x)),
#                      labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
#   mytheme
# g3
#
wdt <- 32
ht <- 30
if (save_figure)
{  if (!(grepl(".png", filename, fixed = TRUE)))
filename <- paste0(filename,".png")
png(filename, width = wdt, height = ht, units = "cm", res = 300, bg = "white")
}
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.8, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
#   scale_colour_manual(values = gvals, breaks = gbreaks, labels = glabels) +
#   scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
#                        limits=c(1,12), labels=mlabels) +
#   scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
#   scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
#                      breaks = trans_breaks("log10", function(x) 10^round(x)),
#                      labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
#   mytheme
# g3
#
wdt <- 32
ht <- 30
if (save_figure)
{  if (!(grepl(".png", filename, fixed = TRUE)))
filename <- paste0(filename,".png")
png(filename, width = wdt, height = ht, units = "cm", res = 300, bg = "white")
}
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.8, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
source("D:/ACCES/JamesBay/TimeSeries/Jitterplots.R")
ht <- 25
if (save_figure)
{  if (!(grepl(".png", filename, fixed = TRUE)))
filename <- paste0(filename,".png")
png(filename, width = wdt, height = ht, units = "cm", res = 300, bg = "white")
}
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.8, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
ht <- 28
if (save_figure)
{  if (!(grepl(".png", filename, fixed = TRUE)))
filename <- paste0(filename,".png")
png(filename, width = wdt, height = ht, units = "cm", res = 300, bg = "white")
}
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.8, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
z <- split(pdata,pdata$Station)
cag440 <- pdata %>% group_by(Station) %>% summarise(valpoints = sum(!is.na(ag440)))
library(plyr)
cag440 <- pdata %>% group_by(Station) %>% summarise(valpoints = sum(!is.na(ag440)))
library(plyr)
cag440 <- pdata %>% group_by(Station) %>% summarise(valpoints = sum(!is.na(ag440)))
library(dplyr)
cag440 <- pdata %>% group_by(Station) %>% summarise(valpoints = sum(!is.na(ag440)))
View(cag440)
cag440 <- pdata %>% group_by(Station) %>% summarise(valpoints = sum(!is.na(ag440)))
cchl <- pdata %>% group_by(Station) %>% summarise(valpoints = sum(!is.na(chl)))
cspm <- pdata %>% group_by(Station) %>% summarise(valpoints = sum(!is.na(spmr)))
cag440 <- cag440[match(gbreaks, cag440$Station),]
cspm <- cspm[match(gbreaks, cspm$Station),]
cchl <- cchl[match(gbreaks, cchl$Station),]
ratio.display=4.5
xlim <- c(1,length(station))
ylbl <- expression(paste(italic("a"),{}[g],"(440 nm) [",m^{-1},"]"))
ymax <- max(pdata$ag440,na.rm=TRUE)
ylim <- c(0,ymax+0.1*ymax)
ratio.values <- (xlim[2]-xlim[1])/(ylim[2]-ylim[1])
asp_rat <- ratio.values/ratio.display
g1 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks),y = ag440, fill=Month),
shape=21,show.legend = TRUE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = ag440),trim=FALSE,show.legend = FALSE,alpha =0,size=1,color="black") +
annotate("text", x = c(1:length(station)), y=70, label = paste0("N = ",cag440$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +  #seq(ymin, ymax, ystp)
scale_y_continuous(name = ylbl, limits = ylim,
breaks = pretty_breaks())  +  #seq(ymin, ymax, ystp)
mytheme  + theme(legend.position = c(0,1.25),plot.margin = unit(c(0,0,0,0), "cm"),
axis.text.x = element_blank())
g1
g1 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks),y = ag440, fill=Month),
shape=21,show.legend = TRUE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = ag440),trim=FALSE,show.legend = FALSE,alpha =0,size=1,color="black") +
annotate("text", x = c(1:length(station)), y=ymax, label = paste0("N = ",cag440$valpoints),size = 12/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +  #seq(ymin, ymax, ystp)
scale_y_continuous(name = ylbl, limits = ylim,
breaks = pretty_breaks())  +  #seq(ymin, ymax, ystp)
mytheme  + theme(legend.position = c(0,1.25),plot.margin = unit(c(0,0,0,0), "cm"),
axis.text.x = element_blank())
g1
g1 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks),y = ag440, fill=Month),
shape=21,show.legend = TRUE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = ag440),trim=FALSE,show.legend = FALSE,alpha =0,size=1,color="black") +
annotate("text", x = c(1:length(station)), y=ymax, label = paste0("N = ",cag440$valpoints),size = 8/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +  #seq(ymin, ymax, ystp)
scale_y_continuous(name = ylbl, limits = ylim,
breaks = pretty_breaks())  +  #seq(ymin, ymax, ystp)
mytheme  + theme(legend.position = c(0,1.25),plot.margin = unit(c(0,0,0,0), "cm"),
axis.text.x = element_blank())
g1
ylbl <- expression(paste(italic("C"),{}[SPM]," [g",m^{-3},"]"))
ymax <- max(pdata$spmr,na.rm=TRUE)
ylim <- c(1,100)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g2 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = spmr, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = spmr),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
annotate("text", x = c(1:length(station)), y=ymax, label = paste0("N = ",cspm$valpoints),size = 8/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme  + theme(axis.text.x = element_blank())
g2
ylbl <- expression(paste(italic("C"),{}[Chl-a]," [mg ",m^{-3},"]"))
ymax <- max(pdata$chl,na.rm=TRUE)
ylim <- c(0.1,100)
ratio.values <- (xlim[2]-xlim[1])/(log10(ylim[2])-log10(ylim[1]))
asp_rat <- ratio.values/ratio.display
g3 <- ggplot(data = pdata) +
geom_jitter(aes(x=factor(Station, level = gbreaks) ,y = chl, fill=Month),
shape=21,show.legend = FALSE,stroke=0.1,size=2) +
geom_violin(aes(x=Station ,y = chl),trim=FALSE,show.legend = FALSE,alpha =0,size=1,na.rm=TRUE,color="black")+
annotate("text", x = c(1:length(station)), y=ymax, label = paste0("N = ",cchl$valpoints),size = 8/.pt) +
labs(title = "", color = "", fill = "") +
coord_fixed(ratio = asp_rat, ylim = ylim,
expand = FALSE, clip = "on") +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78_s25(12),breaks=seq(1,12,1),
limits=c(1,12), labels=mlabels) +
scale_x_discrete(name = "", breaks = gbreaks, labels = gnames)  +
scale_y_continuous(name = ylbl, limits = ylim, trans = 'log10',
breaks = trans_breaks("log10", function(x) 10^round(x)),
labels = trans_format("log10", math_format(10^.x)),minor_breaks = log10_minor_break()) +
mytheme
g3
wdt <- 32
ht <- 28
if (save_figure)
{  if (!(grepl(".png", filename, fixed = TRUE)))
filename <- paste0(filename,".png")
png(filename, width = wdt, height = ht, units = "cm", res = 300, bg = "white")
}
library(grid)
panel_width = unit(1,"npc") - sum(ggplotGrob(g1)[["widths"]][-3]) - unit(1,"line")
gg1 <- g1 + guides(fill= guide_colorbar(barwidth = panel_width*0.8, barheight = 0.5))
grid.newpage()
grid.draw(rbind(ggplotGrob(gg1), ggplotGrob(g2), ggplotGrob(g3)))
# Saving the tiff file, if we want to save figure
if (save_figure)
dev.off()
source("D:/ACCES/JamesBay/TimeSeries/Jitterplots.R")
source("D:/ACCES/JamesBay/TimeSeries/Jitterplots.R")
